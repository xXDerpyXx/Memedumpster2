<script src="/socket.io/socket.io.js"></script>
<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
<script>
	//var audio = new Audio('note.mp3');
	var url = window.location.href;
	var timer = setInterval(displayColor,100);
	function displayColor(){
		document.getElementById("colorBox").style.backgroundColor = "#"+document.getElementById("colorBox").value;
		document.getElementById("memeForm").action = url+"upload";
		document.getElementById("memePic").src = "images/picture.png";
	}
	var recent = false;
	var socket = io();
	function sendMessage(){
		if(recent == false){
			var message = document.getElementById("mainBox").value;
			var color = document.getElementById("colorBox").value;
			socket.emit('chat message',message,color)
			document.getElementById("mainBox").value = "";
			recent = true;
			setTimeout(function(){recent=false;},3000);
	}else{
		//response.sendRedirect("https://www.youtube.com/watch?v=dQw4w9WgXcQ");
	}
  }
  socket.on('return message', function(msg,count,sound){
		document.getElementById("messages").innerHTML = msg;
		document.getElementById("divers").innerHTML = count+"";
		audio = document.getElementById("note");
		if(sound==true){
			audio.play();
		}
  });
  
function uploadMeme(){
	alert("MEME UPLOADING")
	
}
  

  
</script>
<audio id="note">
	<source src="note.mp3"/>
</audio>
<style>
#messages{
	max-height:250px;
	overflow:auto;
	width:750px;
	margin:auto;
}
#chatStuffs{
		margin:auto;
		padding:5px;
}
#chattingStuffs{
		margin:auto;
		width:750;
}
#all{
	width:1000px;
	margin:auto;
	background-color:aa99ff;
}
#mainTitle{
	text-align:center;
}
#memeTitle{
	text-align:center;
}
#mainBox{
	width:750px;
	margin:auto;
	height:30px;
	background-color:ddccff;
}
#mainButton{
	width:750px;
}
#memeForm{
	margin:auto;
}
#memePic{
	margin:auto;
	max-width:750px;
	margin-left:125px;
}
#memeStuff{
	margin:auto;
	width:750px;
}
</style>
	<div id="all">
		<div id="mainTitle">
			<h1>Memedumpster V2</h1>
			<h3>Dumpster Divers: <span id="divers">0</span></h3>
		</div>
	<div></div>
	<div id="chatStuffs">
		<div id="chattingStuffs">
			<span>color(hexadecimal):</span>
			<input type="text" id="colorBox"/>
			<!--<span id="dispColor">Current Color</span>-->
			<input type="text" id="mainBox"/>
			<!--<input id="mainButton" type="button" onClick="sendMessage()" value="Push me!"/>-->
			</div>
		<div>
			<div id="messages"></div>
		</div>
	</div>
	<div>
		<br/>
		<h1 id="memeTitle">Today's Meme</h1>
		<img id="memePic" src=""/>
		<div id="memeStuff">
			<form id="memeForm" action="" method="post" encType="multipart/form-data">
				<input type="file" id="memeFile" name="tempFile"/> 
				<input type="submit" value="SUBMIT MEME"/>
			</form>
		</div>
	</div>
</div>

<script>
  document.getElementById('mainBox').onkeypress = function(e){
    if (!e) e = window.event;
    var keyCode = e.keyCode || e.which;
    if (keyCode == '13'){
      sendMessage();
      return false;
    }
  }
	/*socket.on('meme', function(meme){
		document.getElementById("memePic").src = meme;
		tempFile = document.getElementById('memeFile');
		uploader.upload(tempFile);
	});
	uploader.on('start', function(fileInfo) {
		console.log('Start uploading', fileInfo);
	});*/
</script>


